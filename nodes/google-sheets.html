<script type="text/javascript">
    RED.nodes.registerType('iqhome-google-sheets',{
        category: 'iqhome',
        color: '#C0DEED',
        defaults: {
            name: {value: ""},
            scriptURL: {value: "", required: true},
            sheetURL: {value: "", required: true}
        },
        inputs: 1,
        outputs: 0,
        icon: "font-awesome/fa-table",
        label: function() {
            return this.name||"Google Sheets";
		},
        paletteLabel: "google sheets",
    });
</script>

<script type="text/html" data-template-name="iqhome-google-sheets">
	<div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <br>
    <p>You can find the documentation here:
        <a href="#" target="popup" style="color: #ad1625" onclick="window.open('https://www.iqhome.org/uploading-sensor-data-to-google-spreadsheet-with-node-red','newwindow','width='+screen.width+',height='+screen.height);return false;">IQHome Google Sheets</a></p>
    <br>
    <div class="form-row">
        <label for="node-input-scriptURL"><i class="fa fa-link"></i> Script URL</label>
        <input type="text" id="node-input-scriptURL">
    </div>
    <div class="form-row">
        <label for="node-input-sheetURL"><i class="fa fa-link"></i> Sheet URL</label>
        <input type="text" id="node-input-sheetURL">
    </div>
</script>

<script type="text/html" data-help-name="iqhome-google-sheets">
    <p>
		Post incoming data to Google Sheets.
    </p>
    
    <h3>Input</h3>
    <ol class="node-ports">
        <li>Input
			<dl class="message-properties">
				<dt>payload <span class="property-type">object</span></dt>
				<dd>array containing measurement data objects from each sensor connected to the gateway</dd>
            </dl>
		</li>
    </ol>

	<h3>Details</h3>
    <p>
        This node logs data to 3 sheets in a single spreadsheet.
        These sheets must have the names <b>Temperature, Humidity, CO2</b>.
        It also adds a timestamp as the first column.
    </p>
</script>
